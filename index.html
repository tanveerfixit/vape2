<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Vape Supplier Order Builder</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-slate-100 text-slate-800">

<header class="bg-white shadow px-6 py-4">
  <h1 class="text-xl font-bold">Vape Supplier Order Builder</h1>
  <p class="text-sm text-slate-500">Mobile-friendly â€¢ Keyboard suggestions â€¢ WhatsApp ready</p>
</header>

<main class="p-6 grid grid-cols-1 lg:grid-cols-3 gap-6">

  <!-- ================= PRODUCT INPUT ================= -->
  <section class="lg:col-span-2 space-y-4">

    <div class="bg-white rounded shadow p-4">
      <h2 class="font-semibold mb-3">Add Product</h2>

      <div class="grid grid-cols-1 md:grid-cols-4 gap-3 mb-2">

        <!-- CATEGORY -->
        <input id="category"
          list="categoryList"
          placeholder="Category"
          class="border p-2 rounded">

        <!-- BRAND -->
        <input id="brand"
          list="brandList"
          placeholder="Brand"
          class="border p-2 rounded">

        <!-- PRODUCT LINE -->
        <input id="line"
          list="lineList"
          placeholder="Product Line"
          class="border p-2 rounded">

        <!-- FLAVOUR -->
        <div>
          <input id="flavour"
            list="flavourList"
            placeholder="Flavour"
            class="border p-2 rounded w-full">
          <p id="flavourHint" class="text-xs text-slate-500 mt-1"></p>
        </div>
      </div>

      <div class="flex gap-3 items-center">
        <input id="qty" type="number" min="1" value="1"
          class="border p-2 rounded w-24">
        <button onclick="addToOrder()"
          class="bg-green-600 text-white px-4 py-2 rounded">
          Add to Order
        </button>
      </div>
    </div>

    <!-- ================= CURRENT ORDER ================= -->
    <div class="bg-white rounded shadow p-4">
      <h2 class="font-semibold mb-2">Current Order</h2>

      <table class="w-full text-sm">
        <thead class="bg-slate-200">
          <tr>
            <th class="p-2 text-left">#</th>
            <th class="p-2 text-left">Product</th>
            <th class="p-2 text-left">Flavour</th>
            <th class="p-2 text-right">Qty</th>
          </tr>
        </thead>
        <tbody id="orderTable"></tbody>
      </table>
    </div>

  </section>

  <!-- ================= SHAREABLE ORDER ================= -->
  <aside>

    <div class="bg-white rounded shadow p-4">
      <h2 class="font-semibold mb-2">Shareable Order</h2>

      <textarea id="orderOutput" rows="18"
        class="w-full border p-2 rounded text-sm"
        placeholder="Order will appear hereâ€¦"></textarea>

      <button onclick="copyOrder()"
        class="mt-3 w-full bg-blue-600 text-white py-2 rounded">
        Copy for WhatsApp
      </button>

      <p id="msg" class="mt-2 text-sm font-semibold"></p>
    </div>

  </aside>

</main>

<!-- ================= SCRIPT ================= -->
<script>
/* =========================
   PRODUCT DATABASE
========================= */
const products = [
  { category: "Disposable Vape", brand: "Lost Mary", line: "BM6000" },
  { category: "Disposable Vape", brand: "IVG", line: "Smart 5500" },
  { category: "Disposable Vape", brand: "IVG", line: "Bar Plus" },
  { category: "Disposable Vape", brand: "Elf Bar", line: "BC5000" },
  { category: "Disposable Vape", brand: "Elf Bar", line: "BM600" },

  { category: "E-Liquid (Nic Salt)", brand: "ELFLIQ", line: "Nic Salts Series" },
  { category: "E-Liquid (Nic Salt)", brand: "MARYLIQ", line: "Nic Salts Series" },

  { category: "Nicotine Pouch", brand: "KILLA", line: "Slim Pouch" },
  { category: "Nicotine Pouch", brand: "CUBA", line: "Slim Pouch" }
];

/* =========================
   FLAVOUR SUGGESTIONS
========================= */
const flavourSuggestions = [
  "Banana Ice",
  "Blue Razz Lemonade",
  "Blueberry Sour Raspberry",
  "Cherry Cola",
  "Cola Ice",
  "Grape",
  "Mango Ice",
  "Menthol",
  "Orange",
  "Peach Ice",
  "Pineapple Ice",
  "Spearmint",
  "Strawberry Ice",
  "Strawberry Watermelon",
  "Watermelon Ice"
];

/* =========================
   STATE
========================= */
let order = [];

/* =========================
   ELEMENTS
========================= */
const categoryEl = document.getElementById("category");
const brandEl = document.getElementById("brand");
const lineEl = document.getElementById("line");
const flavourEl = document.getElementById("flavour");
const flavourHint = document.getElementById("flavourHint");

/* =========================
   UTILITIES
========================= */
const unique = (arr, key) =>
  [...new Set(arr.map(i => i[key]))];

function fillDatalist(id, values) {
  const dl = document.getElementById(id);
  dl.innerHTML = values.map(v => `<option value="${v}">`).join("");
}

/* =========================
   INIT DATALISTS
========================= */
document.body.insertAdjacentHTML("beforeend", `
  <datalist id="categoryList"></datalist>
  <datalist id="brandList"></datalist>
  <datalist id="lineList"></datalist>
  <datalist id="flavourList"></datalist>
`);

fillDatalist("categoryList", unique(products, "category"));
fillDatalist("flavourList", flavourSuggestions);

/* =========================
   DEPENDENT SUGGESTIONS
========================= */
categoryEl.addEventListener("input", () => {
  const filtered = products.filter(p =>
    p.category === categoryEl.value
  );
  fillDatalist("brandList", unique(filtered, "brand"));
});

brandEl.addEventListener("input", () => {
  const filtered = products.filter(p =>
    p.category === categoryEl.value &&
    p.brand === brandEl.value
  );
  fillDatalist("lineList", unique(filtered, "line"));
});

/* =========================
   FLAVOUR FREE TEXT LOGIC
========================= */
flavourEl.addEventListener("input", () => {
  const v = flavourEl.value.toLowerCase();
  const match = flavourSuggestions.some(f =>
    f.toLowerCase().includes(v)
  );

  flavourHint.textContent =
    v && !match
      ? "New flavour will be added as entered"
      : "";
});

/* =========================
   ORDER LOGIC
========================= */
function addToOrder() {
  if (!categoryEl.value || !brandEl.value || !lineEl.value || !flavourEl.value) return;

  order.push({
    category: categoryEl.value,
    brand: brandEl.value,
    line: lineEl.value,
    flavour: flavourEl.value.trim(),
    qty: Number(qty.value)
  });

  flavourEl.value = "";
  flavourHint.textContent = "";
  renderOrder();
}

function renderOrder() {
  orderTable.innerHTML = order.map((i, idx) => `
    <tr class="border-t">
      <td class="p-2">${idx + 1}</td>
      <td class="p-2">${i.brand} ${i.line}</td>
      <td class="p-2">${i.flavour}</td>
      <td class="p-2 text-right">${i.qty}</td>
    </tr>
  `).join("");

  orderOutput.value = [
    "ðŸ§¾ Vape Order",
    "",
    ...order.map((i, idx) =>
      `${idx + 1}) ${i.brand} ${i.line}\n` +
      `   â€¢ Category: ${i.category}\n` +
      `   â€¢ Flavour: ${i.flavour}\n` +
      `   â€¢ Qty: ${i.qty}\n`
    )
  ].join("\n");
}

function copyOrder() {
  orderOutput.select();
  document.execCommand("copy");
  msg.textContent = "âœ… Order copied for WhatsApp";
  msg.className = "text-green-600 font-semibold mt-2";
}
</script>

</body>
</html>
